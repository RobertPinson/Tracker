function initAvatarUpload(){$("#avatar-upload-form").ajaxForm({beforeSend:function(){updateProgress(0),$("#avatar-upload-form").addClass("hidden")},uploadProgress:function(a,e,t,o){updateProgress(o)},success:function(a){if(updateProgress(100),a.success===!1)$("#status").html(a.errorMessage);else{var e=$("#crop-avatar-target");e.attr("src",a.fileName),keepUploadBox||$("#avatar-upload-box").addClass("hidden"),$("#avatar-crop-box").removeClass("hidden"),initAvatarCrop(e)}},error:function(a){var e=jQuery.parseJSON(a.responseText);alert("Message: "+e.Message),alert("StackTrace: "+e.StackTrace),alert("ExceptionType: "+e.ExceptionType)},complete:function(a){}})}function updateProgress(a){$(".upload-percent-bar").width(a+"%"),$(".upload-percent-value").html(a+"%"),0===a&&($("#upload-status").empty(),$(".upload-progress").removeClass("hidden"))}function initAvatarCrop(a){a.Jcrop({onChange:setCoordsAndImgSize,aspectRatio:1,setSelect:[175,100,400,300]},function(){{var a=this;a.initComponent("Thumbnailer",{width:130,height:130})}})}function setCoordsAndImgSize(a){imageCropWidth=a.w,imageCropHeight=a.h,cropPointX=a.x,cropPointY=a.y}function saveAvatar(){{var a=$("#Id").attr("value");$(".jcrop-thumb")}$("#avatar-crop-box button").addClass("disabled"),$.ajax({type:"POST",url:"/People/Save",traditional:!0,data:{id:a,imagePath:$("#crop-avatar-target").attr("src"),cropPointX:cropPointX,cropPointY:cropPointY,imageCropWidth:imageCropWidth,imageCropHeight:imageCropHeight}}).done(function(a){a.success===!0?($("#avatar-result img").attr("src","data:image/png;base64,"+a.avatar),$("#avatar-result").removeClass("hidden"),keepCropBox||$("#avatar-crop-box").addClass("hidden")):alert(a.errorMessage)}).fail(function(a){alert("Cannot upload avatar at this time")})}var imageCropWidth=0,imageCropHeight=0,cropPointX=0,cropPointY=0,maxSizeAllowed=2,maxSizeInBytes=1024*maxSizeAllowed*1024,keepUploadBox=!1,keepCropBox=!1;$(function(){void 0!==typeof $("#avatar-upload-form")&&(initAvatarUpload(),$("#avatar-max-size").html(maxSizeAllowed),$("#avatar-upload-form input:file").on("change",function(a){var e=a.currentTarget.files;for(var t in e)"item"!==e[t].name&&"undefined"!=typeof e[t].name&&(e[t].size<=maxSizeInBytes?($("#avatar-upload-form .upload-file-notice").removeClass("bg-danger"),$("#avatar-upload-form").submit()):$("#avatar-upload-form .upload-file-notice").addClass("bg-danger"))})),$("#profile-image-save").on("click",function(){saveAvatar()}),$(".avatar-img").on("click",function(){$("#avatar-container").hide(),$("#avatar-edit-container").show()})});